---
title: "MATCH UP TABLE - PATCH 2.12/2.13"
description: |
base_url: https://llorr-stats.netlify.app
# preview: "https://static.wikia.nocookie.net/leagueoflegends/images/d/df/03NX007T1_Sentinel-full.png"
# date: 07-21-2021
output: distill::distill_article
    # toc: true
    # toc_float: true
    # toc_depth: 3
    # self_contained: false
draft: false
twitter:
  site: "@Maou_Legna"
  creator: "@Maou_Legna"
params:
  # prev:  "2021-07-07 21:00:00" #UTC tz / 'previous' week start
  start: "2021-07-14 21:00:00" #UTC tz / 'current' week start
  # end:   "2021-07-21 21:00:00" #UTC tz / 'current' week end
  skip:  1888233  # Patch 2.11 - after removing a few games
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  error = FALSE,
  message = FALSE,
  dev.args = list(bg = 'transparent'),
  # dev='svglite',
  fig.align='center',
  #out.width='75%', fig.asp=.75,
  cache.rebuild = F,
  cache = F
)

# source(file.path("C:","LlorR","scripts","lor_main.R" ))
options(digits.secs = 6)
options(scipen=999)

library(tidyverse)
library(data.table)
library(DT)
```

```{r load-data}
# file.Match.DT   <- list.files(path = file.path("C:","LlorR","data","clean" ), pattern = "LoR_Melt_MatchDT_", full.names = T) %>% max()
# LoR.Melt.Matches.RMD <- fread(file.Match.DT, header = T, na.strings = c("", NA))
```

```{r load-MU}
file.MU.DT   <- list.files(path = file.path("C:","LlorR","data","clean" ), pattern = "MUtbl_", full.names = T) %>% max()
MUtbl <- fread(file.MU.DT, header = T, na.strings = c("", NA))
```

# Match Up Table

Number of **matches**: `r sum(MUtbl$muGames)/2` / **games** : `r sum(MUtbl$muGames)`

Last Update: `r Sys.time()`

Since the values aren't too heavily affected by new data I won't update it too often. Will probably be each 2 days or so (more often at the start of a season). [^1]

[^1]: since I had to implement a couple of corrections I can 'confirm' that updating the file is a bit heavy sometimes to my 'potato pc', even worse if it happens during the data collection. So I have to confirm I can't update it hourly/all days as I would ideally.

While on the report I do some filtering removing cases with too few games, here I left EVERYTHING to allows people plays as much as they want with the table (as usual from Ranked games), so if you want to remove "the dirt" **remember to use the filter**.

---

```{r print-tableGrid, layout="l-page", preview=TRUE}
MUtbl.DT <- MUtbl %>% 
  # filter(muGames>30) %>%
  mutate( direction = replace(direction, muWR==0.5, "TIE" ) ) %>%
  mutate( player = factor(player), opponent = factor(opponent), direction = factor(direction), okCI = factor(okCI) ) %>%
  select( -CI ) %>%
  datatable(., rownames = FALSE, colnames = c('Player'='player','Opponent'='opponent','Regions'='factions','Win Rate'='muWR','#Wins'='muWin','#Games'='muGames','LowerCI'='LCI','UpperCI'='UCI','Direction MU'='direction','Result Test'='okCI'),
            # options = list(filter = 'top'),
            filter = list(position = 'top', clear = FALSE)
  ) %>% 
  formatPercentage('Win Rate', 1) %>%
  formatPercentage('LowerCI', 1) %>%
  formatPercentage('UpperCI', 1)

MUtbl.DT
```

---

The format of the table is the usual way I display the match-ups data but I also displayed additional variables that I normally remove in the report:

* **Regions** - regions of the 'Player' deck. In case I may add an 'Oppo-Region' additional column.

* **LowerCI / UpperCI** - are simply the lower and upper bound of the confidence interval, it can help in case one to restrict the result based on the "precision" of the win rate estimation (not the correct statistical definition but a 'semplification').

* **Result Test** - if true it means that the unidirectional test for testing if the **direction** of the MU is correct has a p-value lower than 0.05 (it reject the hyphotesis of the win rate being a 0.5 giving support to the hypothesis that the direction of the MU is indeed correct. Again not the exact definmition. Use to filter the results that is safer to assume are correct regarding the **direction** of the MU.

* **Direction MU** - simply if the MU is positive or negative for the 'Player' (or tie in case the win rate is exactly 0.5)

I'm planning to improve and expand the options once I decide how to implement the ideas I have.